from matplotlib import pyplot as plt
from sklearn.metrics import auc

from ResultShow import DrawROC


def kFold():
    fpr_our = [0, 0, 0, 0.03125, 0.03125, 0.0625, 0.0625, 0.09375, 0.09375, 0.125, 0.125, 0.15625, 0.15625, 0.28125,
               0.28125, 0.3125, 0.3125, 0.4375, 0.4375, 1.0]
    tpr_our = [0, 0.02941176, 0.05882353, 0.05882353, 0.5, 0.5, 0.52941176, 0.52941176, 0.73529412, 0.73529412,
               0.79411765,
               0.79411765, 0.85294118, 0.85294118, 0.88235294, 0.88235294, 0.91176471, 0.91176471, 1.0, 1.0]
    auc_our = 0.8924632352941176

    fpr_drf = [0., 0., 0., 0.02439024, 0.02439024, 0.07317073,
               0.07317073, 0.09756098, 0.09756098, 0.14634146, 0.14634146, 0.17073171,
               0.17073171, 0.19512195, 0.19512195, 0.24390244, 0.24390244, 0.31707317,
               0.31707317, 0.82926829, 0.82926829, 1.]
    tpr_drf = [0., 0.04, 0.36, 0.36, 0.44, 0.44, 0.6, 0.6, 0.64, 0.64, 0.68, 0.68, 0.76, 0.76,
               0.8, 0.8, 0.92, 0.92, 0.96, 0.96, 1., 1.]
    auc_drf = 0.8800

    fpr_dsvm = [0.0, 0.0, 0.03125, 0.03125, 0.0625, 0.0625, 0.125, 0.125, 0.15625, 0.15625, 0.21875, 0.21875, 0.25,
                0.25, 0.4375, 0.4375, 0.59375, 0.59375, 1.0]
    tpr_dsvm = [0.0, 0.029411764705882353, 0.029411764705882353, 0.5, 0.5, 0.5294117647058824, 0.5294117647058824,
                0.5588235294117647, 0.5588235294117647, 0.8235294117647058, 0.8235294117647058, 0.9117647058823529,
                0.9117647058823529, 0.9411764705882353, 0.9411764705882353, 0.9705882352941176, 0.9705882352941176, 1.0,
                1.0]
    auc_dsvm = 0.8814

    fpr_cnn = [0, 0, 0, 0.01449275, 0.01449275, 0.02898551, 0.02898551, 0.04347826, 0.04347826, 0.05797101, 0.05797101,
               0.08695652, 0.08695652, 0.11594203, 0.11594203, 0.13043478, 0.13043478, 0.17391304, 0.17391304,
               0.1884058,
               0.1884058, 0.20289855, 0.20289855, 0.2173913, 0.2173913, 0.23188406, 0.23188406, 0.24637681, 0.24637681,
               0.26086957, 0.26086957, 0.30434783, 0.30434783, 0.33333333, 0.33333333, 0.36231884, 0.36231884,
               0.42028986,
               0.42028986, 0.50724638, 0.50724638, 0.52173913, 0.52173913, 0.56521739, 0.56521739, 0.60869565,
               0.60869565,
               0.66666667, 0.66666667, 0.68115942, 0.68115942, 0.73913043, 0.73913043, 0.75362319, 0.75362319,
               0.79710145,
               0.79710145, 0.8115942, 0.8115942, 0.82608696, 0.82608696, 0.92753623, 0.92753623, 1.0]
    tpr_cnn = [0, 0.015625, 0.1875, 0.1875, 0.203125, 0.203125, 0.21875, 0.21875, 0.296875, 0.296875, 0.3125, 0.3125,
               0.328125,
               0.328125, 0.34375, 0.34375, 0.359375, 0.359375, 0.46875, 0.46875, 0.484375, 0.484375, 0.5, 0.5, 0.578125,
               0.578125,
               0.59375, 0.59375, 0.609375, 0.609375, 0.640625, 0.640625, 0.65625, 0.65625, 0.71875, 0.71875, 0.734375,
               0.734375,
               0.765625, 0.765625, 0.78125, 0.78125, 0.796875, 0.796875, 0.828125, 0.828125, 0.84375, 0.84375, 0.875,
               0.875,
               0.890625, 0.890625, 0.90625, 0.90625, 0.9375, 0.9375, 0.953125, 0.953125, 0.96875, 0.96875, 0.984375,
               0.984375,
               1.0, 1.0]
    auc_cnn = 0.7253170289855073

    fpr_lstm = [0, 0, 0, 0.01449275, 0.01449275, 0.05797101, 0.05797101, 0.07246377, 0.07246377, 0.08695652, 0.08695652,
                0.10144928, 0.10144928, 0.11594203, 0.11594203, 0.14492754, 0.14492754, 0.17391304, 0.17391304,
                0.23188406,
                0.23188406, 0.24637681, 0.24637681, 0.28985507, 0.28985507, 0.43478261, 0.43478261, 0.44927536,
                0.44927536,
                0.46376812, 0.46376812, 0.49275362, 0.49275362, 0.52173913, 0.52173913, 0.56521739, 0.56521739,
                0.62318841,
                0.62318841, 0.66666667, 0.66666667, 0.7826087, 0.7826087, 0.88405797, 0.88405797, 0.94202899,
                0.94202899, 1.0]
    tpr_lstm = [0, 0.01587302, 0.12698413, 0.12698413, 0.15873016, 0.15873016, 0.41269841, 0.41269841, 0.44444444,
                0.44444444,
                0.46031746, 0.46031746, 0.49206349, 0.49206349, 0.68253968, 0.68253968, 0.6984127, 0.6984127,
                0.74603175,
                0.74603175, 0.77777778, 0.77777778, 0.79365079, 0.79365079, 0.80952381, 0.80952381, 0.82539683,
                0.82539683,
                0.85714286, 0.85714286, 0.87301587, 0.87301587, 0.88888889, 0.88888889, 0.9047619, 0.9047619,
                0.92063492,
                0.92063492, 0.93650794, 0.93650794, 0.95238095, 0.95238095, 0.96825397, 0.96825397, 0.98412698,
                0.98412698, 1.0,
                1.0]
    auc_lstm = 0.8138946399815965

    fpr_cla = [0, 0, 0, 0.01449275, 0.01449275, 0.02898551, 0.02898551, 0.04347826, 0.04347826, 0.05797101, 0.05797101,
               0.07246377, 0.07246377, 0.08695652, 0.08695652, 0.10144928, 0.10144928, 0.11594203, 0.11594203,
               0.13043478,
               0.13043478, 0.14492754, 0.14492754, 0.15942029, 0.15942029, 0.23188406, 0.23188406, 0.26086957,
               0.26086957,
               0.28985507, 0.28985507, 0.31884058, 0.31884058, 0.33333333, 0.33333333, 0.4057971, 0.4057971, 0.46376812,
               0.46376812, 0.47826087, 0.47826087, 0.53623188, 0.53623188, 0.5942029, 0.5942029, 0.63768116, 0.63768116,
               0.72463768, 0.72463768, 1.0]
    tpr_cla = [0, 0.01587302, 0.15873016, 0.15873016, 0.22222222, 0.22222222, 0.23809524, 0.23809524, 0.25396825,
               0.25396825,
               0.36507937, 0.36507937, 0.3968254, 0.3968254, 0.49206349, 0.49206349, 0.50793651, 0.50793651, 0.55555556,
               0.55555556, 0.65079365, 0.65079365, 0.71428571, 0.71428571, 0.76190476, 0.76190476, 0.79365079,
               0.79365079,
               0.80952381, 0.80952381, 0.84126984, 0.84126984, 0.85714286, 0.85714286, 0.87301587, 0.87301587,
               0.88888889,
               0.88888889, 0.9047619, 0.9047619, 0.92063492, 0.92063492, 0.95238095, 0.95238095, 0.96825397, 0.96825397,
               0.98412698, 0.98412698, 1.0, 1.0]
    auc_cla = 0.8440303657694962

    fpr_fc = [0, 0, 0, 0.01449275, 0.01449275, 0.02898551, 0.02898551, 0.04347826, 0.04347826, 0.05797101, 0.05797101,
              0.07246377, 0.07246377, 0.08695652, 0.08695652, 0.10144928, 0.10144928, 0.13043478, 0.13043478,
              0.15942029,
              0.15942029, 0.17391304, 0.17391304, 0.20289855, 0.20289855, 0.2173913, 0.2173913, 0.23188406, 0.23188406,
              0.24637681, 0.24637681, 0.26086957, 0.26086957, 0.27536232, 0.27536232, 0.30434783, 0.30434783,
              0.46376812,
              0.46376812, 0.49275362, 0.49275362, 0.50724638, 0.50724638, 0.68115942, 0.68115942, 0.85507246,
              0.85507246, 1.0]
    tpr_fc = [0, 0.015625, 0.171875, 0.171875, 0.234375, 0.234375, 0.265625, 0.265625, 0.28125, 0.28125, 0.4375, 0.4375,
              0.46875,
              0.46875, 0.53125, 0.53125, 0.578125, 0.578125, 0.640625, 0.640625, 0.671875, 0.671875, 0.703125, 0.703125,
              0.71875,
              0.71875, 0.734375, 0.734375, 0.765625, 0.765625, 0.796875, 0.796875, 0.8125, 0.8125, 0.890625, 0.890625,
              0.90625,
              0.90625, 0.9375, 0.9375, 0.953125, 0.953125, 0.96875, 0.96875, 0.984375, 0.984375, 1.0, 1.0]
    auc_fc = 0.8514492753623188

    fpr_fc_aal = [0, 0, 0, 0.01515152, 0.01515152, 0.03030303, 0.03030303, 0.04545455, 0.04545455, 0.06060606,
                  0.06060606,
                  0.07575758, 0.07575758, 0.09090909, 0.09090909, 0.12121212, 0.12121212, 0.15151515, 0.15151515,
                  0.18181818,
                  0.18181818, 0.25757576, 0.25757576, 0.28787879, 0.28787879, 0.37878788, 0.37878788, 0.39393939,
                  0.39393939,
                  0.46969697, 0.46969697, 0.48484848, 0.48484848, 0.51515152, 0.51515152, 0.62121212, 0.62121212,
                  0.68181818,
                  0.68181818, 0.6969697, 0.6969697, 0.92424242, 0.92424242, 1.0]
    tpr_fc_aal = [0, 0.01449275, 0.1884058, 0.1884058, 0.34782609, 0.34782609, 0.49275362, 0.49275362, 0.52173913,
                  0.52173913,
                  0.56521739, 0.56521739, 0.68115942, 0.68115942, 0.69565217, 0.69565217, 0.73913043, 0.73913043,
                  0.76811594,
                  0.76811594, 0.7826087, 0.7826087, 0.8115942, 0.8115942, 0.82608696, 0.82608696, 0.86956522,
                  0.86956522, 0.88405797,
                  0.88405797, 0.89855072, 0.89855072, 0.92753623, 0.92753623, 0.94202899, 0.94202899, 0.95652174,
                  0.95652174,
                  0.97101449, 0.97101449, 0.98550725, 0.98550725, 1.0, 1.0]
    auc_fc_aal = 0.8623188405797101

    plt.figure()
    plt.plot([0, 1], [0, 1], 'k--')
    plt.plot(fpr_our, tpr_our, label="our method: {:.3f}".format(auc_our), linewidth=3)
    plt.plot(fpr_drf, tpr_drf, label="LR: {:.3f}".format(auc_drf))
    plt.plot(fpr_dsvm, tpr_dsvm, label="SVM: {:.3f}".format(auc_dsvm))
    plt.plot(fpr_cnn, tpr_cnn, label="CNN: {:.3f}".format(auc_cnn))
    plt.plot(fpr_lstm, tpr_lstm, label="LSTM: {:.3f}".format(auc_lstm))
    plt.plot(fpr_cla, tpr_cla, label="CLAttention: {:.3f}".format(auc_cla))
    plt.plot(fpr_fc, tpr_fc, label="FCN: {:.3f}".format(auc_fc))

    plt.xlabel('FPR',fontsize=13)
    plt.ylabel('TPR',fontsize=13)
    # plt.title(f'ROC curve')
    plt.legend()
    plt.savefig(f"test.png", dpi=500)
    plt.show()


def oneSite():
    pass


if __name__ == '__main__':
    kFold()
